@model MvcFlowers.Models.Bouqet

<form asp-action="Create">
    <h3>Создание букета</h3>
    <h4>Добавить цветы в букет</h4>

    <div id="flowers">
        <select id="flowerSelect">
            <option value="">-- Выберите цветок --</option>
            @foreach (var flower in ViewBag.AvailableFlowers)
            {
                <option value="@flower.Value">@flower.Text</option>
            }
        </select>
        <button type="button" id="addFlowerButton">Добавить цветок</button>
    </div>

    <h4>Добавленные цветы:</h4>
    <ul id="flowerList"></ul> <!-- Список для отображения добавленных цветов -->
    <!-- Скрытое поле для передачи идентификаторов выбранных цветов -->
    <input type="hidden" asp-for="SelectedFlowerIds" id="SelectedFlowerIds" />
    <button type="submit">Создать букет</button>
</form>

@section Scripts {
    <script>
        const flowerList = document.getElementById('flowerList');
        const flowerSelect = document.getElementById('flowerSelect');
        const selectedFlowerIdsInput = document.getElementById('SelectedFlowerIds');

        document.getElementById('addFlowerButton').addEventListener('click', function () {
            const selectedFlowerId = flowerSelect.value;
            const selectedFlowerText = flowerSelect.options[flowerSelect.selectedIndex].text;

            if (selectedFlowerId) {
                // Добавление цветка в список на странице
                const listItem = document.createElement('li');
                listItem.textContent = selectedFlowerText;
                flowerList.appendChild(listItem);

                // Обновление скрытого поля с идентификаторами
                const currentIds = selectedFlowerIdsInput.value ? selectedFlowerIdsInput.value.split(',') : [];
                if (!currentIds.includes(selectedFlowerId)) {
                    currentIds.push(selectedFlowerId);
                    selectedFlowerIdsInput.value = currentIds.join(',');
                }

                console.log("Добавленный цветок ID: " + selectedFlowerId);
                console.log("Текущие выбранные ID: " + selectedFlowerIdsInput.value);
            } else {
                alert("Пожалуйста, выберите цветок.");
            }
        });
    </script>
}
